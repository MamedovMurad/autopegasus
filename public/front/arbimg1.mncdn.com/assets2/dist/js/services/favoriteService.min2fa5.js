var arabam;!function(t){var e=function(){function t(t,e,r,i){this.$q=t,this.HttpHelperService=e,this.$window=r,this.$rootScope=i,this.favoriteList={addDate:void 0,list:[]}}return t.prototype.init=function(){var e=this;return!!this.isBrowserCompatible()&&(this.readLocalStorage(),this.favoriteList&&(this.favoriteList.addDate&&this.favoriteList.addDate+864e5<Date.now()||!this.favoriteList.addDate)&&this.getFavoritesFromService().then(function(t){e.favoriteList.list=t,e.writeLocalStorage()}),!0)},t.prototype.toggleFavorite=function(t){var e=this;return e.checkIfFavorited(t)?e.removeFromFavorite(t):e.addToFavorite(t)},t.prototype.addToFavorite=function(e,t){var r=this.$q.defer(),i=this,o={AdvertId:e};return this.HttpHelperService.httpPost("/ilan/favori",o,function(t){i.favoriteList.list.push(e),i.writeLocalStorage(),i.$rootScope.UnreadFavCount=+i.$rootScope.UnreadFavCount+1,r.resolve(t.Success)},function(t){r.reject(t)},{isNotLoading:!0}),r.promise},t.prototype.removeFromFavorite=function(e){var r=this.$q.defer(),i=this;return this.HttpHelperService.httpDelete("/ilan/favorisil?Id="+e,function(t){i.favoriteList.list.splice(i.favoriteList.list.indexOf(e),1),i.writeLocalStorage(),i.$rootScope.UnreadFavCount=+i.$rootScope.UnreadFavCount-1,r.resolve(t.Success)},function(t){r.reject(t)},{isNotLoading:!0}),r.promise},t.prototype.getFavoritesFromService=function(){var e=this.$q.defer();return this.HttpHelperService.httpGetWithPromise("/ilan/favoriilanlar",{isNotLoading:!0}).then(function(t){e.resolve(t.Data)}).catch(function(t){e.reject(t)}),e.promise},t.prototype.checkIfFavorited=function(t){return!(!this.favoriteList||!this.favoriteList.list)&&-1<this.favoriteList.list.indexOf(t)},t.prototype.writeLocalStorage=function(){try{this.favoriteList.addDate=Date.now(),localStorage.setItem("favoriteList",JSON.stringify(this.favoriteList))}catch(t){return!1}return!0},t.prototype.readLocalStorage=function(){try{var t=localStorage.getItem("favoriteList");t&&(this.favoriteList=JSON.parse(t))}catch(t){return!1}return!0},t.prototype.storageAvailable=function(t){try{var e=this.$window[t],r="__storage_test__";return e.setItem(r,r),e.removeItem(r),!0}catch(t){return!1}},t.prototype.isBrowserCompatible=function(){var t=!1;return(t=this.storageAvailable("localStorage"))||(t=this.storageAvailable("sessionStorage")),t},t.$inject=["$q","HttpHelperService","$window","$rootScope"],t}();t.FavoriteService=e,angular.module("arabam").service("FavoriteService",e)}(arabam||(arabam={}));
//# sourceMappingURL=favoriteService.min.js.map
